# 加载Fisher线性判别分析的包
library("MASS")
# 设置工作路径
setwd("D:\\softwares\\applied statistics\\rcodelearning\\chap6\\sourcecode")
# 样本
classX1 <- data.frame(
    x1 = c(
        6.60, 6.60, 6.10, 6.10, 8.40, 7.2, 8.40, 7.50,
        7.50, 8.30, 7.80, 7.80
    ),
    x2 = c(
        39.00, 39.00, 47.00, 47.00, 32.00, 6.0, 113.00, 52.00,
        52.00, 113.00, 172.00, 172.00
    ),
    x3 = c(
        1.00, 1.00, 1.00, 1.00, 2.00, 1.0, 3.50, 1.00,
        3.50, 0.00, 1.00, 1.50
    ),
    x4 = c(
        6.00, 6.00, 6.00, 6.00, 7.50, 7.0, 6.00, 6.00,
        7.50, 7.50, 3.50, 3.00
    ),
    x5 = c(
        6.00, 12.00, 6.00, 12.00, 19.00, 28.0, 18.00, 12.00,
        6.00, 35.00, 14.00, 15.00
    ),
    x6 = c(
        0.12, 0.12, 0.08, 0.08, 0.35, 0.3, 0.15, 0.16, 0.16,
        0.12, 0.21, 0.21
    ),
    x7 = c(
        20.00, 20.00, 12.00, 12.00, 75.00, 30.0, 75.00, 40.00,
        40.00, 180.00, 45.00, 45.00
    )
)
classX2 <- data.frame(
    x1 = c(
        8.40, 8.40, 8.40, 6.3, 7.00, 7.00, 7.00, 8.30,
        8.30, 7.2, 7.2, 7.2, 5.50, 8.40, 8.40, 7.50,
        7.50, 8.30, 8.30, 8.30, 8.30, 7.80, 7.80
    ),
    x2 = c(
        32.0, 32.00, 32.00, 11.0, 8.00, 8.00, 8.00, 161.00,
        161.0, 6.0, 6.0, 6.0, 6.00, 113.00, 113.00, 52.00,
        52.00, 97.00, 97.00, 89.00, 56.00, 172.00, 283.00
    ),
    x3 = c(
        1.00, 2.00, 2.50, 4.5, 4.50, 6.00, 1.50, 1.50,
        0.50, 3.5, 1.0, 1.0, 2.50, 3.50, 3.50, 1.00,
        1.00, 0.00, 2.50, 0.00, 1.50, 1.00, 1.00
    ),
    x4 = c(
        5.00, 9.00, 4.00, 7.5, 4.50, 7.50, 6.00, 4.00,
        2.50, 4.0, 3.0, 6.0, 3.00, 4.50, 4.50, 6.00,
        7.50, 6.00, 6.00, 6.00, 6.00, 3.50, 4.50
    ),
    x5 = c(
        4.00, 10.00, 10.00, 3.0, 9.00, 4.00, 1.00, 4.00,
        1.00, 12.0, 3.0, 5.0, 7.00, 6.00, 8.00, 6.00,
        8.00, 5.00, 5.00, 10.00, 13.00, 6.00, 6.00
    ),
    x6 = c(
        0.35, 0.35, 0.35, 0.2, 0.25, 0.25, 0.25, 0.08,
        0.08, 0.30, 0.3, 0.3, 0.18, 0.15, 0.15, 0.16,
        0.16, 0.15, 0.15, 0.16, 0.25, 0.21, 0.18
    ),
    x7 = c(
        75.00, 75.00, 75.00, 15.0, 30.00, 30.00, 30.00, 70.00,
        70.00, 30.0, 30.0, 30.0, 18.00, 75.00, 75.00, 40.00,
        40.00, 180.00, 180.00, 180.00, 180.00, 45.00, 45.00
    )
)
# 分类因子变量
G <- factor(c(rep(1, 12), rep(2, 23)))
# 按行合并
dataf <- rbind(classX1, classX2)
# 按列合并
dataf <- cbind(dataf, G)
# 建立Fisher线性判别分析模型
mod <- MASS::lda(
    G ~ ., # 公式
    prior = rep(0.5, 2), # 先验概率各位1/2，即不考虑贝叶斯判别
    data = dataf # 数据
)
print(mod)
# 训练集上预测
res <- predict(mod)
print(res)
# 训练集上的预测准确率，混淆矩阵
tab <- table(G, res$class)
print(tab)
# 训练集上的预测准确率
print(sum(diag(prop.table(tab))))
# 保存工作空间
save.image("R3.RData")
